{include file="$include_tpl/includes/head.html"}



<body>

    <div id="wrapper">

        {include file="$include_tpl/includes/top.html"}

        {include file="$include_tpl/includes/side.html"}

        <div id="page-wrapper">

            <div id="page-inner">

                <div class="row">

                    <div class="col-md-12">

                        <h1 class="page-header">

                            {$title} <small>{$sub_title}</small>

                        </h1>

                        <!-- ol class="breadcrumb">

                          <li><a href="{$homeurl}">Home</a></li>

                          <li><a href="{$homeurl}/laporan_pesanan/">{$title}</a></li>

                          <li class="active">{$sub_title}</li>

                        </ol -->

                    </div>

                </div>

				

                <!-- /. ROW  -->

                <div class="row">                    

                    

                    <div class="form-group">

                        <div id="alert_success" class="form-group" style="display: none;">                         

                            <div class="alert alert-info">&nbsp;</div>

                        </div>



                        <div id="alert_error" class="form-group" style="display: none;">

                            <div class="alert alert-danger">&nbsp;</div>

                        </div>

                    </div>

                    

                    <div class="form-group">

                        <table style="width: 100%;">

                            <tr>

                                <td width="15%" style="padding: 10px;"><label>Dari Tanggal:</label></td>

                                <td width="85%">

                                    <table width="100%">

                                        <tr>

                                            <td width="40%">

                                                <input type="text" value="{$tanggal_dari}" class="form-control tanggal" name="tanggal_dari" placeholder="Klik Untuk Memilih Tanggal" />

                                            </td>

                                            <td style="text-align: center;">

                                                <label>Sd. Tanggal:</label>

                                            </td>

                                            <td width="40%">

                                                <input type="text" value="{$tanggal_sampai}" class="form-control tanggal" name="tanggal_sampai" placeholder="Klik Untuk Memilih Tanggal" />                                        

                                            </td>

                                        </tr>

                                    </table>

                                </td>

                                <td>&nbsp;</td>

                                <td><div id="btn_cari" type="submit" class="btn btn-primary">Tampilkan</div></td>                                

                            </tr>                            

                        </table>

                    </div>

                    

                    <div class="form-group">

                        <div id="ekspor_xls" class="btn btn-info">Eksport To Xls</div>

                        <div id="ekspor_pdf" class="btn btn-info">Eksport To Pdf</div>

                    </div>

                    

                    <div id="detail" class="table-responsive">

                        <table class="table table-striped table-bordered table-hover">

                                <thead>

                                    <tr>

                                        <th width="10%"><div style="text-align: center;">No.</div></th>

                                        <th width="30%"><div style="text-align: center;">Tanggal</div></th>

                                        <th width="30%"><div style="text-align: center;">Total Order</div></th>

                                        <th width="30%"><div style="text-align: center;">Total Qty</div></th>

                                    </tr>

                                </thead>

                                <tbody>

                                    {assign var="no" value=1}

                                    {foreach $listdetail as $entry}                                    

                                        <tr id="baris_{$entry.id}">

                                            <td align="center">{$limitpage*($currentpage-1)+$no}</td>

                                            <td align="center">{$entry.tanggal}</td>                                                                                 

                                            <td align="right"><span style="font-weight: bold;">{$entry.jumlah}</span></td>                                                                                   

                                            <td align="right"><span style="font-weight: bold;">{$entry.total_qty}</span></td>                                                                                   

                                        </tr>

                                        {assign var="no" value=$no+1}  

                                    {/foreach}

                                    <tr>

                                        <td colspan="2" align="right"><span style="font-weight: bold;">TOTAL:&nbsp;&nbsp;</span></td>

                                        <td align="right"><span style="font-weight: bold;">{$jumlah}</span></td>

                                        <td align="right"><span style="font-weight: bold;">{$total_qty}</span></td>

                                    </tr>

                                </tbody>

                                {if $totalpage gt 1}

                                <tfoot><tr><th colspan="4">

                                    <div style="text-align: center;">

                                        {if $currentpage gt 1}                                

                                            <a class="btn btn-default" href="detailpesanan.php?id={$id_member}&page={$currentpage-1}{if $tanggal_dari neq ''}&tanggal_dari={$tanggal_dari}{/if}{if $tanggal_sampai neq ''}&tanggal_dari={$tanggal_sampai}{/if}">&larr; Prev</a>

                                        {/if}

                                        {assign var="item" value=$frompage}

                                        {for $foo=$frompage to $untilpage}

                                            {if $item eq $currentpage}

                                                <span class="btn btn-info">{$item}</span>                                

                                            {else}

                                                <a class="btn btn-default" href="detailpesanan.php?id={$id_member}&page={$item}{if $tanggal_dari neq ''}&tanggal_dari={$tanggal_dari}{/if}{if $tanggal_sampai neq ''}&tanggal_dari={$tanggal_sampai}{/if}">{$item}</a>

                                            {/if}

                                            {assign var="item" value=$item+1}                                

                                        {/for}

                                        {if $totalpage gt $currentpage}                                

                                            <a class="btn btn-default" href="detailpesanan.php?id={$id_member}&page={$currentpage+1}{if $tanggal_dari neq ''}&tanggal_dari={$tanggal_dari}{/if}{if $tanggal_sampai neq ''}&tanggal_dari={$tanggal_sampai}{/if}">Next &rarr;</a>

                                        {/if}                                

                                    </div>  

                            </th></tr></tfoot>

                            {/if}

                        </table>

                    </div>

                </div>

                <!-- /. ROW  -->

                

                {include file="$include_tpl/includes/footer.html"}

            </div>

            <!-- /. PAGE INNER  -->

        </div>

        <!-- /. PAGE WRAPPER  -->

    </div>

    

    {include file="$include_tpl/includes/footer_js.html"}

    

    <link href="{$tpl_dir}/assets/datepick/jquery.datepick.css" rel="stylesheet">

    <script src="{$tpl_dir}/assets/datepick/jquery.plugin.js"></script>

    <script src="{$tpl_dir}/assets/datepick/jquery.datepick.js"></script>

    <script type="text/javascript">

        $(function () {

            $('.tanggal').datepick({ dateFormat: 'dd-mm-yyyy' });

            

            $( "#btn_cari" ).click(function() {                

                var tanggal_dari = $( '[name=tanggal_dari]' ).val();

                var tanggal_sampai = $( '[name=tanggal_sampai]' ).val();

                

                window.location='detailpesanan.php?id={$id_member}'+

                    (tanggal_dari.length>0?'&tanggal_dari='+tanggal_dari:'')+

                    (tanggal_sampai.length>0?'&tanggal_sampai='+tanggal_sampai:'');            

            });

            function setMessage(type, message) {

                $('#alert_'+type+' .alert').text(message);

                $('#alert_'+type).show('slow');

                setTimeout(function() {

                    $('#alert_'+type).hide('slow');

                }, 5000);

                $("body, html").animate({ 

                    scrollTop: $('#wrapper').offset().top 

                }, 600);

            }        



            $( "#ekspor_xls" ).click(function() {

                var tanggal_dari = $( '[name=tanggal_dari]' ).val();

                var tanggal_sampai = $( '[name=tanggal_sampai]' ).val();



                $.ajax({

                    type: 'POST',

                    url: 'ekspor.php?id={$id_member}&tanggal_dari='+tanggal_dari+'&tanggal_sampai='+tanggal_sampai,

                    cache: false,

                    dataType: 'json',

                    processData: false, // Don't process the files

                    contentType: false, // Set content type to false as jQuery will tell the server its a query string request

                    success: function(data, textStatus, jqXHR) {

                        if(data['success']) {

                            window.location = '{$adminweburl}/readFile.php?name=' + data['filename'];

                        } else {

                            setMessage('error', data['message']);

                        }

                    }, 

                    error: function(jqXHR, textStatus, errorThrown) {

                        setMessage('error', 'Terjadi kesalahan system.');

                    }

                });

            });

            

            $( "#ekspor_pdf" ).click(function() {

                var tanggal_dari = $( '[name=tanggal_dari]' ).val();

                var tanggal_sampai = $( '[name=tanggal_sampai]' ).val();

                var url = 'cetak.php?id={$id_member}&tanggal_dari='+tanggal_dari+'&tanggal_sampai='+tanggal_sampai;

                window.open(url, '_blank');

            });

        });

    </script>

</body>

</html>